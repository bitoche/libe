# CLEANED UP VERSION OF E-LIBRARY!

# Основная документация по проекту

## Важное

При отправке запросов на бекенд должен быть использован протокол HTTPS, 
т.к. отправляются конфиденциальные данные.
Для этого будет необходимо получить сертификат, 
либо создать самоподписанный, 
раскомментить строки в application.properties, 
и добавить в securityConfig строчку `.requiresSecure()`;


## Запуск проекта
1. Клонировать репозиторий
2. Создать копию файла .env.restore и переименовать в .env
3. Заполнить необходимые поля в .env, а именно
   1. Хост бд
   2. Порт бд
   3. Пользователь бд
   4. Пароль пользователя бд
   5. Имя бд
   6. Логин для почтового сервиса
   7. Токен для почтового сервиса
   8. Уровни логирования
4. Создать **локально** БД с помощью ddl-я (src/main/resources/scripts/create_all_tables.sql)
    - В DockerDesktop можно скачать Postgres, и задать параметры для сервера БД
5. Запустить проект (в intellij idea с помощью запуска LibeApplication.java)

## Swagger
Доступ к Swagger организован по ссылке `localhost:8080/` (пока фронта нет, реализована переадресация на сваггер)

- Выполнение некоторых функций swagger требует авторизации, необходимо будет создать пользователя в бд с нужной ролью. (пароль необходимо захешировать с помощью BCryptPasswordEncoder при прямом добавлении)
- Так же есть возможность создать пользователя с помощью админского метода (в данный момент он не требует прав администратора)


# Ролевая модель
### В проекте используется ролевая модель для ограничения доступов пользователей.

#### Реализованы роли:
- **Librarian** - Библиотекарь
- **Admin** - Администратор
- **Teacher** - Преподаватель
- **Student** - Студент
- **Unauthorized** - Посетитель сайта, который еще не зарегистрировался/не авторизовался
- **Authorized** - Авторизованный посетитель сайта

## Роль Librarian - Библиотекарь
**Доступные функции:**
- Все функции роли `Student`
- Управление складом (`warehouse_controller`)
(добавление/изменение/удаление/перемещение книг)
- Заказ книг (`ordering_books`)
- Приемка книг (`books_arriving`)
- Выдача книг (`borrow` | связь с ролью `Student`)

## Роль Admin - Администратор
**Доступные функции:**
- Управление пользователями (`admin_controller`)

(добавление/изменение/удаление пользователей и ролей)

## Роль Teacher - Преподаватель
**Доступные функции:**
- Все функции роли `Student`
- Функция **запроса заказа** книг (связь с ролью `Librarian`)

## Роль Student - Студент
**Доступные функции:**
- Бронирование книг (`borrow` | связь с ролью `Librarian`)
- Получение книг (`borrow` | связь с ролью `Librarian`)
- Авторизация (`auth_controller`)
- Все функции роли `Authorized`

## **Unauthorized** - Посетитель сайта, который еще не зарегистрировался/не авторизовался *(Спец)*
**Доступные функции:**
- Регистрация/Авторизация (`auth_controller`)
- Просмотр каталога (`book_controller`)

## Роль **Authorized** - Авторизованный посетитель сайта *(Спец)*
**Доступные функции:**
- Выход из аккаунта (`auth_controller`)
- Просмотр пользователей (`user_controller`)
- Просмотр каталога (`book_controller`)